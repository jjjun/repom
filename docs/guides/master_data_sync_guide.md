# ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿åŒæœŸã‚¬ã‚¤ãƒ‰

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€`db_sync_master` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ãŸãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

- [æ¦‚è¦](#æ¦‚è¦)
- [åŸºæœ¬çš„ãªä½¿ã„æ–¹](#åŸºæœ¬çš„ãªä½¿ã„æ–¹)
- [ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ](#ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ)
- [å®Ÿè¡Œæ–¹æ³•](#å®Ÿè¡Œæ–¹æ³•)
- [ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)
- [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## æ¦‚è¦

### ãªãœãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿åŒæœŸãŒå¿…è¦ã‹ï¼Ÿ

é–‹ç™ºä¸­ã€Alembic ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸æ•´åˆãŒç™ºç”Ÿã—ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å±¥æ­´ã‚’åˆæœŸåŒ–ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
ãã®éš›ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã—ãŸãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚‚å¤±ã‚ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚

`db_sync_master` ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã¨ã¯ç‹¬ç«‹ã—ã¦ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã—ã€
å¿…è¦ãªã¨ãã«ã„ã¤ã§ã‚‚ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½

- **Upsert æ“ä½œ**: INSERT ã¾ãŸã¯ UPDATEï¼ˆæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¯æ›´æ–°ã€æ–°è¦ãƒ‡ãƒ¼ã‚¿ã¯æŒ¿å…¥ï¼‰
- **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†**: å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’1ã¤ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å†…ã§å‡¦ç†
- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ç®¡ç†**: Python ãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å®šç¾©
- **é †åºåˆ¶å¾¡**: ãƒ•ã‚¡ã‚¤ãƒ«åãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆ`001_`, `002_`ï¼‰ã§å®Ÿè¡Œé †åºã‚’åˆ¶å¾¡
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ã‚¨ãƒ©ãƒ¼æ™‚ã¯å…¨ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯

---

## åŸºæœ¬çš„ãªä½¿ã„æ–¹

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
your_project/
â”œâ”€â”€ data_master/              # ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ 001_roles.py         # ãƒ­ãƒ¼ãƒ«ãƒã‚¹ã‚¿
â”‚   â”œâ”€â”€ 002_users.py         # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒã‚¹ã‚¿
â”‚   â””â”€â”€ 003_categories.py    # ã‚«ãƒ†ã‚´ãƒªãƒã‚¹ã‚¿
â””â”€â”€ repom/
    â””â”€â”€ config.py            # master_data_path è¨­å®š
```

### è¨­å®š

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ `root_path/data_master` ãŒãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãªã‚Šã¾ã™ã€‚

```python
# repom/config.pyï¼ˆè‡ªå‹•è¨­å®šï¼‰
config.master_data_path  # => "C:/path/to/project/data_master"
```

**ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºä¾‹**:

```python
# mine_py/config.py
from repom.config import MineDbConfig

class MinePyConfig(MineDbConfig):
    def __init__(self):
        super().__init__()
        # ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¹ã‚’æŒ‡å®š
        self.master_data_path = "/custom/path/to/master_data"

def get_repom_config():
    return MinePyConfig()
```

```bash
# .env
CONFIG_HOOK=mine_py.config:get_repom_config
```

---

## ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

### åŸºæœ¬çš„ãªãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼

```python
# data_master/001_roles.py
from mine_py.models import Role  # ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

# ã©ã®ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹ã‹æŒ‡å®š
MODEL_CLASS = Role

# ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆè¾æ›¸ã®ãƒªã‚¹ãƒˆï¼‰
MASTER_DATA = [
    {"id": 1, "name": "admin", "description": "Administrator"},
    {"id": 2, "name": "user", "description": "Regular User"},
    {"id": 3, "name": "guest", "description": "Guest User"},
]
```

### å¿…é ˆè¦ç´ 

1. **`MODEL_CLASS`**: ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹
2. **`MASTER_DATA`**: list å‹ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆå„è¦ç´ ã¯ dictï¼‰

### ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡

- **ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹**: `001_`, `002_`, `003_` ãªã©ï¼ˆå®Ÿè¡Œé †åºã‚’åˆ¶å¾¡ï¼‰
- **æ‹¡å¼µå­**: `.py`ï¼ˆPython ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- **ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `_` ã§å§‹ã¾ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯ç„¡è¦–ã•ã‚Œã‚‹

**ä¾‹**:

```
data_master/
â”œâ”€â”€ 001_roles.py          # æœ€åˆã«å®Ÿè¡Œ
â”œâ”€â”€ 002_users.py          # 2ç•ªç›®ã«å®Ÿè¡Œï¼ˆroles ã«ä¾å­˜ã™ã‚‹å ´åˆï¼‰
â”œâ”€â”€ 003_categories.py     # 3ç•ªç›®ã«å®Ÿè¡Œ
â””â”€â”€ _template.py          # ç„¡è¦–ã•ã‚Œã‚‹ï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```

---

## å®Ÿè¡Œæ–¹æ³•

### åŸºæœ¬çš„ãªå®Ÿè¡Œ

```bash
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç’°å¢ƒï¼ˆEXEC_ENV=devï¼‰
poetry run db_sync_master
```

### ç’°å¢ƒæŒ‡å®š

```bash
# é–‹ç™ºç’°å¢ƒ
EXEC_ENV=dev poetry run db_sync_master

# æœ¬ç•ªç’°å¢ƒ
EXEC_ENV=prod poetry run db_sync_master

# ãƒ†ã‚¹ãƒˆç’°å¢ƒ
EXEC_ENV=test poetry run db_sync_master
```

### å®Ÿè¡Œçµæœã®ä¾‹

```
============================================================
ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿åŒæœŸé–‹å§‹
============================================================

[1/3] ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ä¸­...
âœ“ ãƒ¢ãƒ‡ãƒ«ã®ãƒ­ãƒ¼ãƒ‰å®Œäº†

[2/3] ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: C:\path\to\project\data_master

[3/3] ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’åŒæœŸä¸­...
  âœ“ Role: 3 ä»¶
  âœ“ User: 5 ä»¶
  âœ“ Category: 10 ä»¶

============================================================
åŒæœŸå®Œäº†: 3 ãƒ•ã‚¡ã‚¤ãƒ«ã€18 ãƒ¬ã‚³ãƒ¼ãƒ‰
============================================================
```

---

## ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚’è€ƒæ…®ã—ãŸé †åº

å¤–éƒ¨ã‚­ãƒ¼ã‚’æŒã¤ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€å‚ç…§å…ˆã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¾Œã«é…ç½®ã—ã¾ã™ã€‚

```
data_master/
â”œâ”€â”€ 001_roles.py          # å‚ç…§ã•ã‚Œã‚‹å´ï¼ˆå…ˆã«å®Ÿè¡Œï¼‰
â”œâ”€â”€ 002_users.py          # roles ã‚’å‚ç…§ï¼ˆå¾Œã«å®Ÿè¡Œï¼‰
â””â”€â”€ 003_user_sessions.py  # users ã‚’å‚ç…§ï¼ˆæœ€å¾Œã«å®Ÿè¡Œï¼‰
```

**ä¾‹**:

```python
# 001_roles.pyï¼ˆå‚ç…§ã•ã‚Œã‚‹å´ï¼‰
MODEL_CLASS = Role
MASTER_DATA = [
    {"id": 1, "name": "admin"},
]

# 002_users.pyï¼ˆå‚ç…§ã™ã‚‹å´ï¼‰
MODEL_CLASS = User
MASTER_DATA = [
    {"id": 1, "name": "Admin User", "role_id": 1},  # roles.id=1 ã‚’å‚ç…§
]
```

### 2. ID ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š

ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã§ã¯ `id` ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®ä¸€è²«æ€§ã‚’ä¿ã¡ã¾ã™ã€‚

```python
MASTER_DATA = [
    {"id": 1, "name": "admin"},   # âœ… ID ã‚’æ˜ç¤º
    {"id": 2, "name": "user"},
]
```

**ç†ç”±**:
- Upsert æ™‚ã®ä¸€è‡´åˆ¤å®šã«ä½¿ç”¨
- ãƒ‡ãƒ¼ã‚¿ã®è¿½è·¡ãŒå®¹æ˜“
- ç’°å¢ƒé–“ã§ã®ãƒ‡ãƒ¼ã‚¿ä¸€è²«æ€§

### 3. é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

**æ¨å¥¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**:

```bash
# 1. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ–
poetry run alembic downgrade base
poetry run alembic upgrade head

# 2. ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’åŒæœŸ
poetry run db_sync_master

# 3. å‹•ä½œç¢ºèª
poetry run python -m your_app
```

### 4. ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†

ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã¯ Git ã§ç®¡ç†ã—ã¾ã™ã€‚

```gitignore
# .gitignore
data/              # ä¸€æ™‚çš„ãªDBãƒ•ã‚¡ã‚¤ãƒ«ã¯é™¤å¤–
!data_master/      # ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã¯å«ã‚ã‚‹
```

### 5. ã‚³ãƒ¡ãƒ³ãƒˆã§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–

```python
# data_master/001_roles.py
"""
ãƒ­ãƒ¼ãƒ«ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿

ã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã™ã‚‹åŸºæœ¬çš„ãªãƒ­ãƒ¼ãƒ«ã‚’å®šç¾©ã—ã¾ã™ã€‚
- admin: ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…
- user: ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼
- guest: ã‚²ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼

æœ€çµ‚æ›´æ–°: 2025-11-19
"""

from mine_py.models import Role

MODEL_CLASS = Role

MASTER_DATA = [
    {
        "id": 1,
        "name": "admin",
        "description": "ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…",
        # æ³¨æ„: admin ãƒ­ãƒ¼ãƒ«ã¯å‰Šé™¤ã—ãªã„ã“ã¨
    },
    # ...
]
```

---

## é«˜åº¦ãªä½¿ã„æ–¹

### å‹•çš„ãªãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ

```python
# data_master/001_categories.py
from mine_py.models import Category
from datetime import datetime

MODEL_CLASS = Category

# å‹•çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
def generate_categories():
    categories = []
    for i in range(1, 11):
        categories.append({
            "id": i,
            "name": f"Category {i}",
            "created_at": datetime.now(),
        })
    return categories

MASTER_DATA = generate_categories()
```

### æ¡ä»¶ä»˜ããƒ‡ãƒ¼ã‚¿

```python
# data_master/001_config.py
import os
from mine_py.models import Config

MODEL_CLASS = Config

# ç’°å¢ƒã«å¿œã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰ãˆã‚‹
EXEC_ENV = os.getenv('EXEC_ENV', 'dev')

if EXEC_ENV == 'prod':
    MASTER_DATA = [
        {"id": 1, "key": "api_url", "value": "https://api.example.com"},
    ]
else:
    MASTER_DATA = [
        {"id": 1, "key": "api_url", "value": "http://localhost:8000"},
    ]
```

### è¤‡é›‘ãªãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

```python
# data_master/002_users_with_roles.py
from mine_py.models import User

MODEL_CLASS = User

# è¤‡æ•°ã®ãƒ­ãƒ¼ãƒ«ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«çµŒç”±ï¼‰
MASTER_DATA = [
    {
        "id": 1,
        "name": "Admin User",
        "email": "admin@example.com",
        # æ³¨æ„: å¤šå¯¾å¤šãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯åˆ¥é€”å‡¦ç†ãŒå¿…è¦
    },
]
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: `MODEL_CLASS ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“`

**åŸå› **: ãƒ•ã‚¡ã‚¤ãƒ«ã« `MODEL_CLASS` ãŒã‚ã‚Šã¾ã›ã‚“ã€‚

**è§£æ±ºç­–**:

```python
# æ­£ã—ã„å½¢å¼
from mine_py.models import Role

MODEL_CLASS = Role  # å¿…é ˆ

MASTER_DATA = [...]
```

### ã‚¨ãƒ©ãƒ¼: `MASTER_DATA ã¯ list å‹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™`

**åŸå› **: `MASTER_DATA` ãŒ list å‹ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

**è§£æ±ºç­–**:

```python
# âŒ é–“é•ã„
MASTER_DATA = {"id": 1, "name": "test"}

# âœ… æ­£ã—ã„
MASTER_DATA = [
    {"id": 1, "name": "test"},
]
```

### ã‚¨ãƒ©ãƒ¼: `no such table: xxx`

**åŸå› **: ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ã¾ã›ã‚“ï¼ˆãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æœªå®Ÿè¡Œï¼‰ã€‚

**è§£æ±ºç­–**:

```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
poetry run alembic upgrade head

# ãã®å¾Œã€ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’åŒæœŸ
poetry run db_sync_master
```

### ã‚¨ãƒ©ãƒ¼: å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„é•å

**åŸå› **: å‚ç…§å…ˆã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã—ãªã„ã€ã¾ãŸã¯ãƒ•ã‚¡ã‚¤ãƒ«ã®é †åºãŒé–“é•ã£ã¦ã„ã‚‹ã€‚

**è§£æ±ºç­–**:

1. ãƒ•ã‚¡ã‚¤ãƒ«ã®é †åºã‚’ç¢ºèªï¼ˆå‚ç…§ã•ã‚Œã‚‹å´ã‚’å…ˆã«å®Ÿè¡Œï¼‰
2. å‚ç…§å…ˆã®IDãŒæ­£ã—ã„ã‹ç¢ºèª

```python
# 001_roles.pyï¼ˆå…ˆã«å®Ÿè¡Œï¼‰
MASTER_DATA = [
    {"id": 1, "name": "admin"},  # ã“ã®IDãŒå­˜åœ¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
]

# 002_users.pyï¼ˆå¾Œã«å®Ÿè¡Œï¼‰
MASTER_DATA = [
    {"id": 1, "name": "Admin", "role_id": 1},  # role_id=1 ã‚’å‚ç…§
]
```

### ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚Œãªã„

**åŸå› **: Upsert ã¯ `id` ã§åˆ¤å®šã—ã¦ã„ã¾ã™ã€‚`id` ãŒä¸€è‡´ã—ãªã„å ´åˆã¯æ–°è¦ INSERT ã•ã‚Œã¾ã™ã€‚

**ç¢ºèªæ–¹æ³•**:

```python
# ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
MASTER_DATA = [
    {"id": 1, "name": "updated name"},  # id=1 ãŒå­˜åœ¨ã™ã‚Œã° UPDATE
]
```

**ãƒ­ã‚°ã‚’ç¢ºèª**:

```bash
poetry run db_sync_master
# å‡ºåŠ›: âœ“ ModelName: 3 ä»¶
```

---

## ã¾ã¨ã‚

### ã‚³ãƒãƒ³ãƒ‰æ—©è¦‹è¡¨

```bash
# åŸºæœ¬å®Ÿè¡Œ
poetry run db_sync_master

# ç’°å¢ƒæŒ‡å®š
EXEC_ENV=dev poetry run db_sync_master
EXEC_ENV=prod poetry run db_sync_master

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ + ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
poetry run alembic upgrade head; poetry run db_sync_master
```

### ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

é–‹ç™ºæ™‚ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼š

- [ ] ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã« `MODEL_CLASS` ã¨ `MASTER_DATA` ã‚’å®šç¾©
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«åã«ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆ`001_`, `002_`ï¼‰ã‚’ä»˜ä¸
- [ ] å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã‚’è€ƒæ…®ã—ãŸé †åºã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®
- [ ] `id` ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š
- [ ] Git ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
- [ ] å®Ÿè¡Œå‰ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆï¼ˆ`poetry run db_backup`ï¼‰

---

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **[ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã‚¬ã‚¤ãƒ‰](session_management_guide.md)** - `transaction()` ã®è©³ç´°
- **[BaseRepository ã‚¬ã‚¤ãƒ‰](repository_and_utilities_guide.md)** - ãƒ‡ãƒ¼ã‚¿æ“ä½œã®è©³ç´°
- **[README.md](../../README.md)** - ã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

---

**æœ€çµ‚æ›´æ–°**: 2025-11-19
